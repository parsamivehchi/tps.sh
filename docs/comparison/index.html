<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tps.sh — Local vs Cloud Showdown</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text y='28' font-size='28'>⚡</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<style>
:root {
  --bg-deep: #060a14;
  --bg-card: #0d1321;
  --bg-surface: #161e2e;
  --border: #1e2a3f;
  --border-glow: #1e3a5f;
  --text-primary: #f0f4f8;
  --text-secondary: #8b9ec2;
  --text-muted: #4a5e82;
  --qwen3: #10b981; --qwen25: #3b82f6;
  --haiku: #06b6d4; --sonnet: #8b5cf6; --opus: #ec4899;
  --accent: #818cf8;
  --glow-opacity: 0.1;
  --noise-opacity: 0.03;
  --nav-bg: rgba(6,10,20,0.85);
}

[data-theme="light"] {
  --bg-deep: #f8f9fc;
  --bg-card: #fff;
  --bg-surface: #eef1f6;
  --border: #d4dae5;
  --border-glow: #b8c4d8;
  --text-primary: #1a202c;
  --text-secondary: #4a5568;
  --text-muted: #a0aec0;
  --accent: #5a67d8;
  --glow-opacity: 0;
  --noise-opacity: 0;
  --nav-bg: rgba(248,249,252,0.9);
}

[data-theme="neon"] {
  --bg-deep: #0a0020;
  --bg-card: #120030;
  --bg-surface: #1a0040;
  --border: #4400aa;
  --border-glow: #6600cc;
  --text-primary: #fff;
  --text-secondary: #c0b0ff;
  --text-muted: #7060aa;
  --accent: #a78bfa;
  --glow-opacity: 0.15;
  --noise-opacity: 0.04;
  --nav-bg: rgba(10,0,32,0.9);
}

[data-theme="solarized"] {
  --bg-deep: #002b36;
  --bg-card: #073642;
  --bg-surface: #0a4050;
  --border: #586e75;
  --border-glow: #657b83;
  --text-primary: #839496;
  --text-secondary: #657b83;
  --text-muted: #586e75;
  --accent: #268bd2;
  --glow-opacity: 0;
  --noise-opacity: 0;
  --nav-bg: rgba(0,43,54,0.9);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; scrollbar-width: thin; scrollbar-color: var(--border) var(--bg-deep); }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg-deep); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
body { font-family: 'Outfit', sans-serif; background: var(--bg-deep); color: var(--text-primary); line-height: 1.6; overflow-x: hidden; }
.mono { font-family: 'IBM Plex Mono', monospace; }
body::before { content: ''; position: fixed; inset: 0; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E"); pointer-events: none; z-index: 9999; opacity: var(--noise-opacity); }
.glow-orb { position: fixed; border-radius: 50%; filter: blur(120px); opacity: var(--glow-opacity); pointer-events: none; z-index: 0; }
.glow-orb.emerald { width: 400px; height: 400px; background: #10b981; top: 5%; left: 10%; }
.glow-orb.violet { width: 350px; height: 350px; background: #8b5cf6; top: 30%; right: 5%; }
.glow-orb.cyan { width: 300px; height: 300px; background: #06b6d4; bottom: 20%; left: 20%; }
.container { max-width: 1260px; margin: 0 auto; padding: 0 24px; position: relative; z-index: 1; }

nav { position: sticky; top: 0; z-index: 100; background: var(--nav-bg); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 14px 0; }
nav .container { display: flex; align-items: center; justify-content: space-between; }
nav .logo { font-weight: 800; font-size: 18px; letter-spacing: -0.5px; }
nav .logo span { color: var(--qwen3); }
nav .nav-links { display: flex; gap: 24px; }
nav .nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 15px; font-weight: 500; letter-spacing: 0.5px; text-transform: uppercase; transition: color 0.2s; }
nav .nav-links a:hover { color: var(--text-primary); }

.hero { padding: 100px 0 80px; text-align: center; }
.hero .badge { display: inline-flex; align-items: center; gap: 8px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 100px; padding: 6px 16px; font-size: 12px; color: var(--text-secondary); margin-bottom: 32px; font-family: 'IBM Plex Mono', monospace; }
.hero .badge .dot { width: 6px; height: 6px; background: var(--qwen3); border-radius: 50%; animation: pulse 2s infinite; }
@keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }
.hero h1 { font-size: clamp(40px, 6vw, 68px); font-weight: 900; letter-spacing: -2px; line-height: 1.05; margin-bottom: 20px; background: linear-gradient(135deg, #f0f4f8 20%, #8b5cf6 50%, #06b6d4 80%, #10b981); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
.hero .subtitle { font-size: 20px; color: var(--text-secondary); max-width: 640px; margin: 0 auto 40px; font-weight: 300; }
.hero .meta-row { display: flex; justify-content: center; gap: 28px; flex-wrap: wrap; }
.hero .meta-item { font-family: 'IBM Plex Mono', monospace; font-size: 12px; color: var(--text-muted); }
.hero .meta-item strong { color: var(--text-secondary); font-weight: 600; }

section { padding: 80px 0; }
.section-label { font-family: 'IBM Plex Mono', monospace; font-size: 13px; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 8px; }
.section-title { font-size: 36px; font-weight: 700; letter-spacing: -1px; margin-bottom: 12px; }
.section-desc { color: var(--text-secondary); font-size: 17px; max-width: 640px; margin-bottom: 48px; }

.group-label { font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); margin-bottom: 12px; padding-left: 4px; }
.model-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; }
.model-grid.three { grid-template-columns: repeat(3, 1fr); }
@media (max-width: 1000px) { .model-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 560px) { .model-grid, .model-grid.three { grid-template-columns: 1fr; } }

.model-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 22px; position: relative; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s; }
.model-card:hover { transform: translateY(-3px); }
.model-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
.model-card .crown { position: absolute; top: 10px; right: 12px; font-size: 18px; }
.model-card .name { font-weight: 700; font-size: 17px; margin-bottom: 1px; }
.model-card .arch { font-family: 'IBM Plex Mono', monospace; font-size: 12px; color: var(--text-muted); margin-bottom: 16px; }
.model-card .stats { display: flex; flex-direction: column; gap: 10px; }
.model-card .stat-row { display: flex; justify-content: space-between; align-items: baseline; }
.model-card .stat-label { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
.model-card .stat-value { font-family: 'IBM Plex Mono', monospace; font-weight: 600; font-size: 18px; }

.chart-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
@media (max-width: 768px) { .chart-grid { grid-template-columns: 1fr; } }
.chart-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 28px; }
.chart-card.full { grid-column: 1 / -1; }
.chart-card h3 { font-size: 17px; font-weight: 600; margin-bottom: 4px; }
.chart-card .chart-desc { font-size: 14px; color: var(--text-muted); margin-bottom: 20px; }
.chart-wrap { position: relative; height: 340px; }
.chart-wrap.tall { height: 420px; }

.speed-bars { display: flex; flex-direction: column; gap: 14px; }
.speed-bar-row { display: grid; grid-template-columns: 170px 1fr 80px; align-items: center; gap: 14px; }
.speed-bar-name { font-weight: 600; font-size: 15px; }
.speed-bar-track { height: 28px; background: var(--bg-surface); border-radius: 8px; overflow: hidden; }
.speed-bar-fill { height: 100%; border-radius: 8px; width: 0; transition: width 1.5s cubic-bezier(0.16, 1, 0.3, 1); position: relative; }
.speed-bar-fill::after { content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 30px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15)); border-radius: 0 8px 8px 0; }
.speed-bar-value { font-family: 'IBM Plex Mono', monospace; font-weight: 600; font-size: 17px; text-align: right; }

.heatmap-grid { display: grid; grid-template-columns: 170px repeat(5, 1fr); gap: 2px; font-size: 12px; }
.heatmap-header { background: var(--bg-surface); padding: 8px 6px; font-weight: 600; font-size: 10px; text-transform: uppercase; letter-spacing: 0.3px; color: var(--text-secondary); text-align: center; border-radius: 4px; }
.heatmap-header.cat-label { text-align: left; padding-left: 10px; }
.heatmap-cell { padding: 12px 6px; text-align: center; border-radius: 4px; font-family: 'IBM Plex Mono', monospace; font-weight: 600; font-size: 12px; transition: transform 0.2s; cursor: default; }
.heatmap-cell:hover { transform: scale(1.08); z-index: 2; }
.heatmap-cat { padding: 12px 10px; background: var(--bg-surface); border-radius: 4px; font-weight: 500; color: var(--text-secondary); font-size: 12px; display: flex; align-items: center; }

.comp-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px; }
.comp-table thead th { background: var(--bg-surface); padding: 10px 12px; text-align: left; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-secondary); font-weight: 600; white-space: nowrap; }
.comp-table thead th:first-child { border-radius: 8px 0 0 0; }
.comp-table thead th:last-child { border-radius: 0 8px 0 0; }
.comp-table tbody td { padding: 12px 12px; border-bottom: 1px solid var(--border); font-family: 'IBM Plex Mono', monospace; font-size: 15px; font-weight: 500; }
.comp-table tbody tr:hover td { background: rgba(255,255,255,0.02); }
.comp-table .model-name-cell { font-family: 'Outfit', sans-serif; font-weight: 600; }
.comp-table .best { font-weight: 700; }

.insight-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 768px) { .insight-cards { grid-template-columns: 1fr; } }
.insight-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; padding: 24px; }
.insight-card .emoji { font-size: 28px; margin-bottom: 12px; }
.insight-card h4 { font-size: 17px; font-weight: 600; margin-bottom: 6px; }
.insight-card p { font-size: 15px; color: var(--text-secondary); line-height: 1.6; }

.quality-badge { display: inline-block; padding: 2px 8px; border-radius: 6px; font-size: 12px; font-weight: 600; font-family: 'IBM Plex Mono', monospace; }
.quality-high { background: rgba(16,185,129,0.15); color: #10b981; }
.quality-mid { background: rgba(59,130,246,0.15); color: #3b82f6; }
.quality-low { background: rgba(244,63,94,0.15); color: #f43f5e; }

footer { border-top: 1px solid var(--border); padding: 40px 0; text-align: center; color: var(--text-muted); font-size: 14px; }

.reveal { opacity: 0; transform: translateY(24px); transition: opacity 0.7s ease, transform 0.7s ease; }
.reveal.visible { opacity: 1; transform: translateY(0); }
.counter { display: inline-block; }

/* Phase indicator */
.phase-indicator { display: flex; justify-content: center; gap: 8px; padding: 12px 0; background: var(--bg-deep); border-bottom: 1px solid var(--border); }
.phase-pill { font-family: 'IBM Plex Mono', monospace; font-size: 11px; letter-spacing: 0.5px; padding: 4px 14px; border-radius: 100px; text-decoration: none; transition: all 0.2s; }
.phase-pill.active { background: var(--accent); color: var(--bg-deep); font-weight: 600; }
.phase-pill.inactive { background: var(--bg-surface); color: var(--text-muted); border: 1px solid var(--border); }
a.phase-pill.inactive:hover { color: var(--text-primary); border-color: var(--accent); }

/* Nav next link */
nav .nav-links a.next-link { color: var(--accent); border: 1px solid var(--accent); padding: 3px 10px; border-radius: 6px; }
nav .nav-links a.next-link:hover { background: var(--accent); color: var(--bg-deep); }

/* Bridge section */
.bridge { padding: 80px 0; }
.bridge-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 48px; max-width: 800px; margin: 0 auto; position: relative; overflow: hidden; text-align: center; }
.bridge-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #818cf8, #10b981, #06b6d4); }
.bridge-label { font-family: 'IBM Plex Mono', monospace; font-size: 11px; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 12px; }
.bridge-title { font-size: 26px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 28px; }
.bridge-stats { display: flex; justify-content: center; gap: 48px; margin-bottom: 28px; flex-wrap: wrap; }
.bridge-stat { text-align: center; }
.bridge-stat .stat-num { font-family: 'IBM Plex Mono', monospace; font-size: 42px; font-weight: 800; line-height: 1; }
.bridge-stat .stat-label { font-size: 12px; color: var(--text-muted); margin-top: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
.bridge-copy { font-size: 15px; color: var(--text-secondary); max-width: 540px; margin: 0 auto 32px; line-height: 1.7; }
.bridge-copy strong { color: var(--text-primary); }
.bridge-cta { display: inline-flex; align-items: center; gap: 8px; background: var(--accent); color: var(--bg-deep); font-weight: 600; font-size: 15px; padding: 12px 28px; border-radius: 10px; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; }
.bridge-cta:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(129,140,248,0.3); }

/* Footer links */
footer a { color: var(--accent); text-decoration: none; }
footer a:hover { text-decoration: underline; }

[data-theme="light"] section[style] { background: var(--bg-surface) !important; }

/* =========================================================
   MOBILE RESPONSIVE — Consolidated Breakpoints
   ========================================================= */

/* -- Mobile nav hamburger toggle -- */
.nav-toggle {
  display: none;
  background: none;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 6px 10px;
  cursor: pointer;
  flex-direction: column;
  gap: 4px;
  align-items: center;
  justify-content: center;
}
.nav-toggle span {
  display: block;
  width: 20px;
  height: 2px;
  background: var(--text-secondary);
  border-radius: 2px;
  transition: transform 0.3s, opacity 0.3s;
}
.nav-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(4px, 4px); }
.nav-toggle.active span:nth-child(2) { opacity: 0; }
.nav-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(4px, -4px); }

/* -- Heatmap scroll wrapper -- */
.heatmap-scroll {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* -- Table scroll wrapper -- */
.table-scroll {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* ===== Tablet breakpoint: 768px ===== */
@media (max-width: 768px) {

  /* Nav */
  nav { padding: 10px 0; }
  .nav-toggle { display: flex; }
  nav .nav-links {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    flex-direction: column;
    background: var(--nav-bg);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 16px 24px;
    gap: 0;
  }
  nav .nav-links.open { display: flex; }
  nav .nav-links a {
    padding: 10px 0;
    font-size: 14px;
    border-bottom: 1px solid var(--border);
  }
  nav .nav-links a:last-child { border-bottom: none; }
  nav .nav-links a.next-link {
    margin-top: 8px;
    text-align: center;
    padding: 8px 0;
  }
  /* Theme buttons row inside mobile menu */
  nav .nav-links > div[style] {
    margin-left: 0 !important;
    margin-top: 12px;
    justify-content: center;
  }

  /* Phase indicator */
  .phase-indicator { gap: 6px; padding: 10px 0; flex-wrap: wrap; justify-content: center; }
  .phase-pill { font-size: 10px; padding: 3px 10px; }

  /* Hero */
  .hero { padding: 64px 0 48px; }
  .hero h1 { font-size: 32px; letter-spacing: -1px; }
  .hero .subtitle { font-size: 16px; margin-bottom: 28px; }
  .hero .meta-row { gap: 14px 20px; }
  .hero .meta-item { font-size: 11px; }
  .hero .badge { font-size: 11px; padding: 5px 12px; margin-bottom: 24px; }

  /* Container */
  .container { padding: 0 16px; }

  /* Section spacing */
  section { padding: 48px 0; }
  .section-title { font-size: 24px; letter-spacing: -0.5px; }
  .section-desc { font-size: 15px; margin-bottom: 32px; }
  .section-label { font-size: 12px; letter-spacing: 2px; }

  /* Charts */
  .chart-card { padding: 20px; }
  .chart-wrap { height: 260px; }
  .chart-wrap.tall { height: 320px; }
  .chart-card h3 { font-size: 15px; }
  .chart-card .chart-desc { font-size: 13px; margin-bottom: 14px; }

  /* Speed bars — stacked layout */
  .speed-bar-row {
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 4px 10px;
  }
  .speed-bar-name {
    grid-column: 1 / -1;
    font-size: 14px;
  }
  .speed-bar-track {
    grid-column: 1;
    grid-row: 2;
    height: 24px;
  }
  .speed-bar-value {
    grid-column: 2;
    grid-row: 2;
    font-size: 15px;
    min-width: 60px;
  }

  /* Heatmap — horizontal scroll */
  .heatmap-grid { min-width: 600px; }
  .heatmap-header { font-size: 9px; padding: 6px 4px; }
  .heatmap-cell { padding: 8px 4px; font-size: 11px; }
  .heatmap-cat { font-size: 11px; padding: 8px 6px; }

  /* Table */
  .comp-table { font-size: 12px; }
  .comp-table thead th { padding: 8px 8px; font-size: 9px; }
  .comp-table tbody td { padding: 8px 8px; font-size: 13px; }

  /* Insight cards */
  .insight-card { padding: 20px; }
  .insight-card .emoji { font-size: 24px; margin-bottom: 8px; }
  .insight-card h4 { font-size: 15px; }
  .insight-card p { font-size: 14px; }

  /* Bridge section */
  .bridge { padding: 48px 0; }
  .bridge-card { padding: 32px 20px; }
  .bridge-title { font-size: 22px; margin-bottom: 20px; }
  .bridge-stats { gap: 24px; margin-bottom: 20px; }
  .bridge-stat .stat-num { font-size: 32px; }
  .bridge-stat .stat-label { font-size: 11px; }
  .bridge-copy { font-size: 14px; margin-bottom: 24px; }
  .bridge-cta { font-size: 14px; padding: 10px 24px; }

  /* Model cards */
  .model-card { padding: 18px; }
  .model-card .name { font-size: 15px; }
  .model-card .stat-value { font-size: 16px; }

  /* Footer */
  footer { padding: 28px 0; font-size: 12px; }
  footer p[style*="font-size:11px"] { font-size: 10px !important; }
  footer p[style*="font-size:13px"] { font-size: 11px !important; }

  /* Glow orbs — reduce for performance */
  .glow-orb { opacity: calc(var(--glow-opacity) * 0.5); }
  .glow-orb.emerald { width: 250px; height: 250px; }
  .glow-orb.violet { width: 200px; height: 200px; }
  .glow-orb.cyan { width: 180px; height: 180px; }
}

/* ===== Small phone breakpoint: 480px ===== */
@media (max-width: 480px) {

  /* Hero */
  .hero { padding: 48px 0 36px; }
  .hero h1 { font-size: 26px; letter-spacing: -0.5px; line-height: 1.1; }
  .hero .subtitle { font-size: 15px; margin-bottom: 24px; }
  .hero .meta-row { gap: 10px 16px; justify-content: center; }
  .hero .meta-item { font-size: 10px; }
  .hero .badge { font-size: 10px; padding: 4px 10px; margin-bottom: 20px; }

  /* Container */
  .container { padding: 0 12px; }

  /* Section */
  section { padding: 36px 0; }
  .section-title { font-size: 21px; }
  .section-desc { font-size: 14px; margin-bottom: 24px; }

  /* Model cards — tighter */
  .model-card { padding: 16px; border-radius: 12px; }
  .model-card .name { font-size: 14px; }
  .model-card .arch { font-size: 11px; }
  .model-card .stat-value { font-size: 15px; }
  .model-card .stat-label { font-size: 11px; }
  .model-card .crown { font-size: 16px; top: 8px; right: 8px; }
  .model-grid, .model-grid.three { gap: 10px; }

  /* Charts */
  .chart-card { padding: 16px; border-radius: 12px; }
  .chart-wrap { height: 220px; }
  .chart-wrap.tall { height: 280px; }
  .chart-card h3 { font-size: 14px; }
  .chart-card .chart-desc { font-size: 12px; margin-bottom: 12px; }
  .chart-grid { gap: 12px; }

  /* Speed bars */
  .speed-bars { gap: 10px; }
  .speed-bar-name { font-size: 13px; }
  .speed-bar-track { height: 20px; }
  .speed-bar-value { font-size: 13px; min-width: 50px; }

  /* Heatmap */
  .heatmap-grid { min-width: 540px; }
  .heatmap-header { font-size: 8px; padding: 5px 3px; }
  .heatmap-cell { padding: 6px 3px; font-size: 10px; }
  .heatmap-cat { font-size: 10px; padding: 6px 4px; }

  /* Table */
  .comp-table thead th { padding: 6px 6px; font-size: 8px; letter-spacing: 0.5px; }
  .comp-table tbody td { padding: 6px 6px; font-size: 12px; }

  /* Insight cards */
  .insight-cards { gap: 10px; }
  .insight-card { padding: 16px; border-radius: 12px; }
  .insight-card .emoji { font-size: 22px; margin-bottom: 6px; }
  .insight-card h4 { font-size: 14px; }
  .insight-card p { font-size: 13px; line-height: 1.5; }

  /* Bridge */
  .bridge { padding: 36px 0; }
  .bridge-card { padding: 24px 16px; border-radius: 12px; }
  .bridge-title { font-size: 19px; margin-bottom: 16px; }
  .bridge-stats { gap: 16px; margin-bottom: 16px; }
  .bridge-stat .stat-num { font-size: 26px; }
  .bridge-stat .stat-label { font-size: 10px; }
  .bridge-copy { font-size: 13px; margin-bottom: 20px; line-height: 1.6; }
  .bridge-cta { font-size: 13px; padding: 10px 20px; border-radius: 8px; }

  /* Phase pills */
  .phase-indicator { padding: 8px 12px; gap: 4px; }
  .phase-pill { font-size: 9px; padding: 3px 8px; }

  /* Footer */
  footer { padding: 24px 0; font-size: 11px; }

  /* Glow orbs — minimal on small screens */
  .glow-orb.emerald { width: 180px; height: 180px; }
  .glow-orb.violet { width: 150px; height: 150px; }
  .glow-orb.cyan { display: none; }

  /* Nav mobile tweaks */
  nav .nav-links { padding: 12px 16px; }
  nav .nav-links a { font-size: 13px; padding: 9px 0; }

  /* Group labels */
  .group-label { font-size: 12px; }
}

/* =========================================================
   Reading Progress Bar
   ========================================================= */
.reading-progress {
  position: fixed;
  top: 0;
  left: 0;
  height: 3px;
  z-index: 10000;
  background: linear-gradient(90deg, var(--emerald, #10b981), var(--accent, #3b82f6));
  width: 0%;
  transition: width 0.1s linear;
  pointer-events: none;
}

/* =========================================================
   Scroll-to-Top Button
   ========================================================= */
.scroll-top-btn {
  position: fixed;
  bottom: 32px;
  right: 32px;
  z-index: 200;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: 1px solid var(--border);
  background: var(--bg-card);
  color: var(--text-secondary);
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s, transform 0.3s, background 0.2s, color 0.2s;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
}
.scroll-top-btn.visible {
  opacity: 1;
  pointer-events: auto;
}
.scroll-top-btn:hover {
  background: var(--accent);
  color: var(--bg-deep);
  border-color: var(--accent);
  transform: translateY(-2px);
}

/* =========================================================
   Keyboard Shortcuts Help Overlay
   ========================================================= */
.shortcuts-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 9000;
  align-items: center;
  justify-content: center;
}
.shortcuts-overlay.open {
  display: flex;
}
.shortcuts-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
}
.shortcuts-panel {
  position: relative;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 32px 36px;
  max-width: 520px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 24px 64px rgba(0,0,0,0.4);
}
.shortcuts-panel h3 {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 24px;
  color: var(--text-primary);
}
.shortcuts-panel .shortcut-group-title {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--accent);
  margin-top: 20px;
  margin-bottom: 10px;
}
.shortcuts-panel .shortcut-group-title:first-of-type {
  margin-top: 0;
}
.shortcuts-panel .shortcut-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 0;
}
.shortcuts-panel .shortcut-row span {
  color: var(--text-secondary);
  font-size: 14px;
}
.shortcuts-close {
  position: absolute;
  top: 16px;
  right: 16px;
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 20px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 6px;
  transition: color 0.2s, background 0.2s;
}
.shortcuts-close:hover {
  color: var(--text-primary);
  background: var(--bg-surface);
}

kbd {
  display: inline-block;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 12px;
  font-weight: 500;
  padding: 2px 8px;
  background: var(--bg-surface);
  border: 1px solid var(--border);
  border-radius: 5px;
  color: var(--text-primary);
  line-height: 1.6;
  min-width: 24px;
  text-align: center;
}

/* =========================================================
   Command Palette
   ========================================================= */
.cmd-palette-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 9500;
  align-items: flex-start;
  justify-content: center;
  padding-top: 18vh;
}
.cmd-palette-overlay.open {
  display: flex;
}
.cmd-palette-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
}
.cmd-palette {
  position: relative;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 14px;
  max-width: 560px;
  width: 92%;
  box-shadow: 0 24px 64px rgba(0,0,0,0.5);
  overflow: hidden;
}
.cmd-palette-input {
  width: 100%;
  background: transparent;
  border: none;
  border-bottom: 1px solid var(--border);
  padding: 16px 20px;
  font-family: 'Outfit', sans-serif;
  font-size: 16px;
  color: var(--text-primary);
  outline: none;
}
.cmd-palette-input::placeholder {
  color: var(--text-muted);
}
.cmd-palette-list {
  max-height: 340px;
  overflow-y: auto;
  padding: 8px;
}
.cmd-palette-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 14px;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.15s;
}
.cmd-palette-item:hover,
.cmd-palette-item.active {
  background: var(--bg-surface);
}
.cmd-palette-item .cmd-cat {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 10px;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  color: var(--text-muted);
  min-width: 70px;
}
.cmd-palette-item .cmd-name {
  font-size: 14px;
  color: var(--text-primary);
  font-weight: 500;
}
.cmd-palette-empty {
  padding: 24px 14px;
  text-align: center;
  color: var(--text-muted);
  font-size: 14px;
}

/* =========================================================
   Section Anchor Links
   ========================================================= */
.section-anchor {
  opacity: 0;
  margin-left: 8px;
  color: var(--text-muted);
  text-decoration: none;
  font-weight: 400;
  transition: opacity 0.2s, color 0.2s;
  cursor: pointer;
  font-size: 0.8em;
  -webkit-text-fill-color: initial;
  background: none;
  -webkit-background-clip: initial;
  background-clip: initial;
}
.section-title:hover .section-anchor,
h3:hover .section-anchor {
  opacity: 1;
}
.section-anchor:hover {
  color: var(--accent);
}
.anchor-toast {
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%) translateY(10px);
  background: var(--bg-card);
  border: 1px solid var(--accent);
  color: var(--accent);
  padding: 8px 18px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  opacity: 0;
  transition: opacity 0.3s, transform 0.3s;
  z-index: 9999;
  pointer-events: none;
}
.anchor-toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* =========================================================
   GitHub Nav Button
   ========================================================= */
.github-nav-btn {
  display: inline-flex;
  align-items: center;
  color: var(--text-secondary);
  transition: color 0.2s, transform 0.2s;
}
.github-nav-btn:hover {
  color: var(--text-primary);
  transform: scale(1.1);
}
.github-nav-btn svg {
  width: 20px;
  height: 20px;
  fill: currentColor;
}

/* =========================================================
   Footer Shortcut Hints
   ========================================================= */
.footer-shortcuts {
  margin-top: 16px;
  font-size: 12px;
  color: var(--text-muted);
}
.footer-shortcuts kbd {
  font-size: 11px;
  padding: 1px 6px;
}

/* =========================================================
   Print Styles
   ========================================================= */
@media print {
  nav, .reading-progress, .scroll-top-btn, .shortcuts-overlay,
  .cmd-palette-overlay, .phase-indicator, .bridge, .anchor-toast,
  .glow-orb, body::before, .nav-toggle, .footer-shortcuts {
    display: none !important;
  }
  body {
    background: #fff !important;
    color: #000 !important;
  }
  * {
    color: #000 !important;
    border-color: #ccc !important;
    box-shadow: none !important;
  }
  .model-card, .chart-card, .insight-card {
    page-break-inside: avoid;
    background: #fff !important;
    border: 1px solid #ccc !important;
  }
  section {
    background: transparent !important;
    page-break-inside: avoid;
  }
  a[href^="http"]::after {
    content: " (" attr(href) ")";
    font-size: 10px;
    color: #666 !important;
  }
  .hero h1 {
    -webkit-text-fill-color: #000 !important;
    background: none !important;
  }
}

/* =========================================================
   Welcome Toast (First Visit)
   ========================================================= */
.welcome-toast {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  z-index: 9998;
  opacity: 0;
  transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.5s ease;
  pointer-events: none;
}
.welcome-toast.visible {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
  pointer-events: auto;
}
.welcome-toast.hiding {
  transform: translateX(-50%) translateY(100px);
  opacity: 0;
}
.welcome-content {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.75rem 1.25rem;
  background: var(--bg-card, rgba(30,30,30,0.95));
  backdrop-filter: blur(12px);
  border: 1px solid var(--border, rgba(255,255,255,0.1));
  border-radius: 12px;
  font-size: 0.85rem;
  color: var(--text-secondary, #aaa);
  box-shadow: 0 4px 24px rgba(0,0,0,0.3);
}
.welcome-content kbd {
  display: inline-block;
  padding: 2px 6px;
  background: rgba(255,255,255,0.1);
  border: 1px solid var(--border, rgba(255,255,255,0.1));
  border-radius: 6px;
  font-size: 0.8rem;
  color: var(--accent, #6366f1);
}
.welcome-dismiss {
  background: none;
  border: none;
  color: var(--text-secondary, #aaa);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 0 0.25rem;
  line-height: 1;
  opacity: 0.7;
  transition: opacity 0.2s;
}
.welcome-dismiss:hover {
  opacity: 1;
}
</style>
<script>
(function(){
  var t = localStorage.getItem('llm-theme');
  if (!t) t = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
  if (t !== 'dark') document.documentElement.setAttribute('data-theme', t);
})();
</script>
</head>
<body>
<div class="reading-progress" id="readingProgress"></div>

<div class="glow-orb emerald"></div>
<div class="glow-orb violet"></div>
<div class="glow-orb cyan"></div>

<nav>
  <div class="container">
    <div class="logo">TPS<span>.</span>SH</div>
    <button class="nav-toggle" aria-label="Toggle navigation" onclick="this.classList.toggle('active');this.nextElementSibling.classList.toggle('open');">
      <span></span><span></span><span></span>
    </button>
    <div class="nav-links">
      <a href="../index.html" style="font-weight:600;">&larr; tps.sh</a>
      <a href="#overview">Overview</a>
      <a href="#speed">Speed</a>
      <a href="#quality">Quality</a>
      <a href="#categories">Categories</a>
      <a href="#deep-dive">Deep Dive</a>
      <a href="#insights">Insights</a>
      <div style="display:flex;gap:4px;align-items:center;margin-left:8px;">
        <button onclick="setTheme('dark')" title="Dark" style="all:unset;cursor:pointer;font-family:'IBM Plex Mono',monospace;font-size:11px;padding:3px 8px;border:1px solid var(--border);color:var(--text-secondary);border-radius:4px;transition:all 0.2s;" data-theme-btn="dark">D</button>
        <button onclick="setTheme('light')" title="Light" style="all:unset;cursor:pointer;font-family:'IBM Plex Mono',monospace;font-size:11px;padding:3px 8px;border:1px solid var(--border);color:var(--text-secondary);border-radius:4px;transition:all 0.2s;" data-theme-btn="light">L</button>
        <button onclick="setTheme('neon')" title="Neon" style="all:unset;cursor:pointer;font-family:'IBM Plex Mono',monospace;font-size:11px;padding:3px 8px;border:1px solid var(--border);color:var(--text-secondary);border-radius:4px;transition:all 0.2s;" data-theme-btn="neon">N</button>
        <button onclick="setTheme('solarized')" title="Solarized" style="all:unset;cursor:pointer;font-family:'IBM Plex Mono',monospace;font-size:11px;padding:3px 8px;border:1px solid var(--border);color:var(--text-secondary);border-radius:4px;transition:all 0.2s;" data-theme-btn="solarized">S</button>
      </div>
      <a href="https://github.com/parsamivehchi/tps.sh" target="_blank" rel="noopener" class="github-nav-btn" title="GitHub Repository"><svg viewBox="0 0 16 16" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a>
      <a href="hardware.html" class="next-link">Hardware Guide &rarr;</a>
    </div>
  </div>
</nav>

<div class="phase-indicator">
  <span class="phase-pill active">Phase 1: Benchmarks</span>
  <a href="hardware.html" class="phase-pill inactive">Phase 2: Hardware Guide</a>
  <a href="https://parsamivehchi.github.io/LLM-Setup-Kit-for-Mac/" target="_blank" class="phase-pill inactive">Phase 3: Setup Kit ↗</a>
</div>

<section class="hero">
  <div class="container">
    <div class="badge"><span class="dot"></span>105 tests &bull; 5 models &bull; Quality scored</div>
    <h1>Local vs Cloud<br>Model Showdown</h1>
    <p class="subtitle">Five LLMs &mdash; 2 local Ollama + 3 Claude API &mdash; tested across 21 coding prompts on Apple M2 Max. Speed, quality, and cost compared.</p>
    <div class="meta-row">
      <div class="meta-item"><strong>Tests</strong> 105</div>
      <div class="meta-item"><strong>Models</strong> 2 local + 3 cloud</div>
      <div class="meta-item"><strong>Hardware</strong> M2 Max &bull; 32GB</div>
      <div class="meta-item"><strong>API Cost</strong> $2.69</div>
      <div class="meta-item"><strong>Quality Judge</strong> Claude Sonnet 4.6</div>
    </div>
  </div>
</section>

<section id="overview">
  <div class="container">
    <div class="section-label reveal">01 / Overview</div>
    <h2 class="section-title reveal">The Five Contenders</h2>
    <p class="section-desc reveal">Two free local models vs three paid Claude models. Is the cloud premium worth it?</p>

    <div class="group-label reveal" style="color: var(--qwen3);">&#x2B24; Local Models (Free &bull; Ollama)</div>
    <div class="model-grid three reveal" style="margin-bottom: 28px; grid-template-columns: repeat(2, 1fr);">
      <div class="model-card" style="--c: var(--qwen3);"><div style="position:absolute;top:0;left:0;right:0;height:3px;background:var(--qwen3);"></div>
        <div class="crown">&#x1F451;</div>
        <div class="name" style="color:var(--qwen3)">qwen3-coder</div><div class="arch">30B MoE &bull; Free &bull; Offline</div>
        <div class="stats">
          <div class="stat-row"><span class="stat-label">Speed</span><span class="stat-value" style="color:var(--qwen3)">48.8 <small style="font-size:11px">tok/s</small></span></div>
          <div class="stat-row"><span class="stat-label">Quality</span><span class="stat-value" style="color:var(--qwen3)">7.48</span></div>
          <div class="stat-row"><span class="stat-label">TTFT</span><span class="stat-value" style="color:var(--qwen3)">1.1s</span></div>
        </div>
      </div>
      <div class="model-card"><div style="position:absolute;top:0;left:0;right:0;height:3px;background:var(--qwen25);"></div>
        <div class="name" style="color:var(--qwen25)">qwen2.5-coder:14b</div><div class="arch">14B Dense &bull; Free &bull; Offline</div>
        <div class="stats">
          <div class="stat-row"><span class="stat-label">Speed</span><span class="stat-value" style="color:var(--qwen25)">15.6 <small style="font-size:11px">tok/s</small></span></div>
          <div class="stat-row"><span class="stat-label">Quality</span><span class="stat-value" style="color:var(--qwen25)">6.64</span></div>
          <div class="stat-row"><span class="stat-label">TTFT</span><span class="stat-value" style="color:var(--qwen25)">1.5s</span></div>
        </div>
      </div>
    </div>

    <div class="group-label reveal" style="color: var(--sonnet);">&#x2B24; Cloud Models (Paid &bull; Anthropic API)</div>
    <div class="model-grid three reveal" style="margin-bottom: 48px;">
      <div class="model-card"><div style="position:absolute;top:0;left:0;right:0;height:3px;background:var(--haiku);"></div>
        <div class="crown">&#x26A1;</div>
        <div class="name" style="color:var(--haiku)">Claude Haiku 4.5</div><div class="arch">Cloud &bull; $0.28</div>
        <div class="stats">
          <div class="stat-row"><span class="stat-label">Speed</span><span class="stat-value" style="color:var(--haiku)">169.7 <small style="font-size:11px">tok/s</small></span></div>
          <div class="stat-row"><span class="stat-label">Quality</span><span class="stat-value" style="color:var(--haiku)">8.25</span></div>
          <div class="stat-row"><span class="stat-label">TTFT</span><span class="stat-value" style="color:var(--haiku)">0.5s</span></div>
        </div>
      </div>
      <div class="model-card"><div style="position:absolute;top:0;left:0;right:0;height:3px;background:var(--sonnet);"></div>
        <div class="name" style="color:var(--sonnet)">Claude Sonnet 4.6</div><div class="arch">Cloud &bull; $0.93</div>
        <div class="stats">
          <div class="stat-row"><span class="stat-label">Speed</span><span class="stat-value" style="color:var(--sonnet)">77.7 <small style="font-size:11px">tok/s</small></span></div>
          <div class="stat-row"><span class="stat-label">Quality</span><span class="stat-value" style="color:var(--sonnet)">8.59</span></div>
          <div class="stat-row"><span class="stat-label">TTFT</span><span class="stat-value" style="color:var(--sonnet)">1.0s</span></div>
        </div>
      </div>
      <div class="model-card"><div style="position:absolute;top:0;left:0;right:0;height:3px;background:var(--opus);"></div>
        <div class="crown">&#x1F3C6;</div>
        <div class="name" style="color:var(--opus)">Claude Opus 4.6</div><div class="arch">Cloud &bull; $1.48</div>
        <div class="stats">
          <div class="stat-row"><span class="stat-label">Speed</span><span class="stat-value" style="color:var(--opus)">76.6 <small style="font-size:11px">tok/s</small></span></div>
          <div class="stat-row"><span class="stat-label">Quality</span><span class="stat-value" style="color:var(--opus)">8.65</span></div>
          <div class="stat-row"><span class="stat-label">TTFT</span><span class="stat-value" style="color:var(--opus)">1.8s</span></div>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="speed" style="background: rgba(13,19,33,0.5);">
  <div class="container">
    <div class="section-label reveal">02 / Speed</div>
    <h2 class="section-title reveal">Generation Speed</h2>
    <p class="section-desc reveal">Tokens per second across all 21 prompts. Cloud models have a massive infrastructure advantage.</p>
    <div class="chart-grid">
      <div class="chart-card full reveal">
        <h3>Tokens per Second</h3>
        <div class="chart-desc">Average generation throughput &mdash; higher is better</div>
        <div class="speed-bars" id="speedBars"></div>
      </div>
      <div class="chart-card reveal">
        <h3>Time to First Token</h3>
        <div class="chart-desc">How quickly each model starts responding</div>
        <div class="chart-wrap"><canvas id="ttftChart"></canvas></div>
      </div>
      <div class="chart-card reveal">
        <h3>Average Response Time</h3>
        <div class="chart-desc">Total end-to-end seconds per prompt</div>
        <div class="chart-wrap"><canvas id="responseTimeChart"></canvas></div>
      </div>
    </div>
  </div>
</section>

<section id="quality">
  <div class="container">
    <div class="section-label reveal">03 / Quality</div>
    <h2 class="section-title reveal">Output Quality Scores</h2>
    <p class="section-desc reveal">Every output scored by Claude Sonnet on correctness (40%), completeness (35%), and clarity (25%). Claude self-scores are flagged for bias.</p>
    <div class="chart-grid">
      <div class="chart-card full reveal">
        <h3>Quality vs Speed Trade-off</h3>
        <div class="chart-desc">The holy grail: top-right corner = fast AND high quality. Bubble size = total tokens output.</div>
        <div class="chart-wrap tall"><canvas id="qualitySpeedChart"></canvas></div>
      </div>
      <div class="chart-card reveal">
        <h3>Quality Scores (Weighted)</h3>
        <div class="chart-desc">Average quality score out of 10</div>
        <div class="chart-wrap"><canvas id="qualityBarChart"></canvas></div>
      </div>
      <div class="chart-card reveal">
        <h3>Cost per Quality Point</h3>
        <div class="chart-desc">API cost divided by quality score &mdash; lower is better</div>
        <div class="chart-wrap"><canvas id="costQualityChart"></canvas></div>
      </div>
    </div>
  </div>
</section>

<section id="categories" style="background: rgba(13,19,33,0.5);">
  <div class="container">
    <div class="section-label reveal">04 / Categories</div>
    <h2 class="section-title reveal">Performance by Task Type</h2>
    <p class="section-desc reveal">Quality scores across 7 coding task categories. Where does each model shine?</p>
    <div class="chart-card full reveal" style="margin-bottom: 24px; overflow-x: auto;">
      <h3>Quality Heatmap &mdash; Score by Category</h3>
      <div class="chart-desc">Color intensity = quality score. Green = high, red = low.</div>
      <div class="heatmap-scroll"><div class="heatmap-grid" id="heatmap"></div></div>
    </div>
    <div class="chart-card full reveal">
      <h3>Category Quality Radar</h3>
      <div class="chart-desc">Quality scores across all 7 task types per model</div>
      <div class="chart-wrap tall"><canvas id="radarChart"></canvas></div>
    </div>
  </div>
</section>

<section id="deep-dive">
  <div class="container">
    <div class="section-label reveal">05 / Full Data</div>
    <h2 class="section-title reveal">Complete Comparison</h2>
    <p class="section-desc reveal">Every metric, every model.</p>
    <div class="chart-card full reveal">
      <div class="table-scroll">
        <table class="comp-table">
          <thead><tr>
            <th>Model</th><th>Type</th><th>TPS</th><th>TTFT</th><th>Avg Time</th><th>Quality</th><th>Tokens</th><th>Cost</th>
          </tr></thead>
          <tbody id="compTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<section id="insights" style="background: rgba(13,19,33,0.5);">
  <div class="container">
    <div class="section-label reveal">06 / Takeaways</div>
    <h2 class="section-title reveal">Key Insights</h2>
    <p class="section-desc reveal">What do 105 tests across 5 models reveal?</p>
    <div class="insight-cards reveal">
      <div class="insight-card">
        <div class="emoji">&#x1F3C6;</div>
        <h4>Cloud Wins on Quality</h4>
        <p>All 3 Claude models scored 8.25+ quality. Opus (8.65) edges Sonnet (8.59) by a hair. The best local model (qwen3-coder at 7.48) trails Haiku by 0.77 points &mdash; meaningful at scale.</p>
      </div>
      <div class="insight-card">
        <div class="emoji">&#x26A1;</div>
        <h4>Haiku is the Speed King</h4>
        <p>At 169.7 tok/s, Claude Haiku 4.5 is 3.5x faster than qwen3-coder and delivers near-Opus quality (8.25 vs 8.65) at 19% of the cost. The best value proposition in this benchmark by far.</p>
      </div>
      <div class="insight-card">
        <div class="emoji">&#x1F4B0;</div>
        <h4>Local = Free but Slower</h4>
        <p>qwen3-coder delivers 7.48 quality at 0 cost &mdash; solid for offline/private use. But Haiku at $0.28 for 21 prompts gets you +0.77 quality and 3.5x speed. The gap is real.</p>
      </div>
    </div>
    <div class="insight-cards reveal" style="margin-top: 16px;">
      <div class="insight-card">
        <div class="emoji">&#x1F9E0;</div>
        <h4>Sonnet = Best Debugger</h4>
        <p>Claude Sonnet 4.6 scored 9.60 on Debugging &amp; Reasoning &mdash; the highest single-category score of any model. For code review and bug-finding, it's unmatched at $0.93.</p>
      </div>
      <div class="insight-card">
        <div class="emoji">&#x1F4BB;</div>
        <h4>qwen3-coder: Local Champion</h4>
        <p>The MoE architecture shines on Apple Silicon &mdash; 48.8 tok/s, 1.1s TTFT, and 7.48 quality. Runs 100% offline on your MacBook with zero internet. Privacy-first, air-gapped, and completely free.</p>
      </div>
      <div class="insight-card">
        <div class="emoji">&#x26A0;</div>
        <h4>Bias Caveat</h4>
        <p>63 of 105 scores involve Claude judging Claude. These are flagged but may inflate cloud scores. A truly fair comparison would need an independent judge (e.g., GPT-4 or human reviewers).</p>
      </div>
    </div>
  </div>
</section>

<section class="bridge">
  <div class="container">
    <div class="bridge-card reveal">
      <div class="bridge-label">What's Next</div>
      <h2 class="bridge-title">Your Local Models Are Fast. Can They Be Faster?</h2>
      <div class="bridge-stats">
        <div class="bridge-stat">
          <div class="stat-num" style="color: var(--qwen3);">48.8</div>
          <div class="stat-label">Local Champion TPS</div>
        </div>
        <div class="bridge-stat">
          <div class="stat-num" style="color: var(--text-muted);">vs</div>
          <div class="stat-label">&nbsp;</div>
        </div>
        <div class="bridge-stat">
          <div class="stat-num" style="color: var(--haiku);">169.7</div>
          <div class="stat-label">Cloud Champion TPS</div>
        </div>
      </div>
      <p class="bridge-copy">The 3.5x speed gap is real &mdash; but it's not about the model. It's about <strong>memory bandwidth</strong>. Better hardware can close that gap.</p>
      <a href="hardware.html" class="bridge-cta">Explore the Hardware Guide &rarr;</a>
    </div>
  </div>
</section>

<footer>
  <div class="container">
    <p>Phase 1: Benchmark Results &bull; 5 Models &bull; 105 Tests &bull; Quality Scored by Claude Sonnet 4.6 &bull; February 2026</p>
    <p style="margin-top:6px;font-size:11px;">63/105 scores flagged for Claude-judging-Claude bias. Local models scored independently. 2 slow models (deepseek-r1, glm-4.7-flash) excluded &mdash; full 7-model data available.</p>
    <p style="margin-top:10px;font-size:13px;"><a href="hardware.html">Phase 2: Hardware Guide &rarr;</a> What's limiting local TPS and how to fix it</p>
    <p style="margin-top:8px;font-size:13px;"><a href="https://parsamivehchi.github.io/LLM-Setup-Kit-for-Mac/" target="_blank">Phase 3: Mac Setup Kit &rarr;</a></p>
    <p style="margin-top:8px;font-size:13px;"><a href="https://github.com/parsamivehchi/tps.sh" target="_blank" rel="noopener">View on GitHub</a></p>
    <p class="footer-shortcuts">Press <kbd>?</kbd> for keyboard shortcuts &middot; <kbd>&#8984;K</kbd> for command palette</p>
  </div>
</footer>

<!-- Scroll to Top Button -->
<button class="scroll-top-btn" id="scrollTopBtn" title="Scroll to top (Home)" aria-label="Scroll to top">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<!-- Keyboard Shortcuts Help Overlay -->
<div class="shortcuts-overlay" id="shortcutsOverlay">
  <div class="shortcuts-backdrop" id="shortcutsBackdrop"></div>
  <div class="shortcuts-panel">
    <button class="shortcuts-close" id="shortcutsClose" aria-label="Close">&times;</button>
    <h3>Keyboard Shortcuts</h3>
    <div class="shortcut-group-title">General</div>
    <div class="shortcut-row"><span>Show this help</span><kbd>?</kbd></div>
    <div class="shortcut-row"><span>Cycle theme</span><kbd>T</kbd></div>
    <div class="shortcut-row"><span>Command palette</span><kbd>&#8984;K</kbd></div>
    <div class="shortcut-row"><span>Close overlay</span><kbd>Esc</kbd></div>
    <div class="shortcut-group-title">Navigation</div>
    <div class="shortcut-row"><span>Scroll to top</span><kbd>Home</kbd> <kbd>0</kbd></div>
    <div class="shortcut-row"><span>Jump to section 1-6</span><kbd>1</kbd> &ndash; <kbd>6</kbd></div>
    <div class="shortcut-group-title">Pages</div>
    <div class="shortcut-row"><span>Landing page</span><kbd>L</kbd></div>
    <div class="shortcut-row"><span>Hardware guide</span><kbd>N</kbd></div>
    <div class="shortcut-row"><span>Setup Kit</span><kbd>M</kbd></div>
    <div class="shortcut-row"><span>Open GitHub</span><kbd>G</kbd></div>
  </div>
</div>

<!-- Command Palette Overlay -->
<div class="cmd-palette-overlay" id="cmdPaletteOverlay">
  <div class="cmd-palette-backdrop" id="cmdPaletteBackdrop"></div>
  <div class="cmd-palette">
    <input class="cmd-palette-input" id="cmdPaletteInput" type="text" placeholder="Type a command..." autocomplete="off" />
    <div class="cmd-palette-list" id="cmdPaletteList"></div>
  </div>
</div>

<!-- Anchor Link Toast -->
<div class="anchor-toast" id="anchorToast">Link copied!</div>

<!-- Welcome Toast (First Visit) -->
<div class="welcome-toast" id="welcomeToast">
  <div class="welcome-content">
    <span class="welcome-text">
      <kbd>?</kbd> shortcuts &nbsp;&middot;&nbsp; <kbd>&#8984;K</kbd> command palette &nbsp;&middot;&nbsp; <kbd>T</kbd> change theme
    </span>
    <button class="welcome-dismiss" id="welcomeDismiss" aria-label="Dismiss">&times;</button>
  </div>
</div>

<script>
const M = [
  { name: 'Claude Haiku 4.5', type: 'Cloud', color: '#06b6d4', tps: 169.7, ttft: 0.5, totalTime: 16.6, quality: 8.25, tokens: 55127, cost: 0.28 },
  { name: 'Claude Sonnet 4.6', type: 'Cloud', color: '#8b5cf6', tps: 77.7, ttft: 1.0, totalTime: 39.9, quality: 8.59, tokens: 60938, cost: 0.93 },
  { name: 'Claude Opus 4.6', type: 'Cloud', color: '#ec4899', tps: 76.6, ttft: 1.8, totalTime: 40.4, quality: 8.65, tokens: 58082, cost: 1.48 },
  { name: 'qwen3-coder', type: 'Local', color: '#10b981', tps: 48.8, ttft: 1.1, totalTime: 37.8, quality: 7.48, tokens: 35063, cost: 0 },
  { name: 'qwen2.5-coder:14b', type: 'Local', color: '#3b82f6', tps: 15.6, ttft: 1.5, totalTime: 68.2, quality: 6.64, tokens: 21595, cost: 0 },
];

const CATS = [
  { label: 'Code Generation', q: [8.7,8.5,8.4,8.5,7.4] },
  { label: 'Debugging & Reasoning', q: [8.8,9.6,9.4,7.8,7.2] },
  { label: 'Short Quick Tasks', q: [9.4,9.7,9.6,9.0,7.9] },
  { label: 'Long Complex Research', q: [7.0,7.5,7.6,6.2,5.2] },
  { label: 'Refactoring', q: [8.3,8.0,9.0,8.6,6.8] },
  { label: 'Explanation & Teaching', q: [7.5,8.0,7.9,5.6,5.4] },
  { label: 'Tool Calling / Agentic', q: [8.1,8.8,8.8,6.9,6.8] },
];
const CAT_REORDERED = CATS.map(c => ({ label: c.label, data: c.q }));

const COLORS = M.map(m => m.color);
const COLORS40 = COLORS.map(c => c + '66');

// Chart instances storage
let chartInstances = {};

function getThemeColors() {
  const style = getComputedStyle(document.documentElement);
  return {
    textColor: style.getPropertyValue('--text-secondary').trim() || '#8b9ec2',
    gridColor: (style.getPropertyValue('--border').trim() || '#1e2a3f') + '44',
    bgDeep: style.getPropertyValue('--bg-deep').trim() || '#060a14',
  };
}

function createAllCharts() {
  // Destroy existing
  Object.values(chartInstances).forEach(c => c.destroy());
  chartInstances = {};

  const tc = getThemeColors();
  Chart.defaults.color = tc.textColor;
  Chart.defaults.borderColor = tc.gridColor;
  Chart.defaults.font.family = "'Outfit', sans-serif";

  // TTFT
  chartInstances.ttft = new Chart(document.getElementById('ttftChart'), {
    type: 'bar', data: { labels: M.map(m => m.name), datasets: [{ data: M.map(m => m.ttft), backgroundColor: COLORS40, borderColor: COLORS, borderWidth: 1.5, borderRadius: 6 }] },
    options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => c.parsed.x.toFixed(1) + 's' } } }, scales: { x: { title: { display: true, text: 'Seconds' }, grid: { color: tc.gridColor } }, y: { grid: { display: false } } } }
  });

  // Response Time
  chartInstances.responseTime = new Chart(document.getElementById('responseTimeChart'), {
    type: 'bar', data: { labels: M.map(m => m.name), datasets: [{ data: M.map(m => m.totalTime), backgroundColor: COLORS40, borderColor: COLORS, borderWidth: 1.5, borderRadius: 6 }] },
    options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => c.parsed.x.toFixed(1) + 's' } } }, scales: { x: { title: { display: true, text: 'Seconds' }, grid: { color: tc.gridColor } }, y: { grid: { display: false } } } }
  });

  // Quality Bar
  chartInstances.qualityBar = new Chart(document.getElementById('qualityBarChart'), {
    type: 'bar', data: { labels: M.map(m => m.name), datasets: [{ data: M.map(m => m.quality), backgroundColor: COLORS40, borderColor: COLORS, borderWidth: 1.5, borderRadius: 6 }] },
    options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => c.parsed.x.toFixed(2) + '/10' } } }, scales: { x: { min: 0, max: 10, title: { display: true, text: 'Score (1-10)' }, grid: { color: tc.gridColor } }, y: { grid: { display: false } } } }
  });

  // Cost per Quality
  const paidM = M.filter(m => m.cost > 0);
  chartInstances.costQuality = new Chart(document.getElementById('costQualityChart'), {
    type: 'bar', data: { labels: [...paidM.map(m => m.name), ...M.filter(m => m.cost === 0).map(m => m.name)],
      datasets: [{ data: [...paidM.map(m => +(m.cost / m.quality).toFixed(4)), ...M.filter(m => m.cost === 0).map(() => 0)],
        backgroundColor: [...paidM.map(m => m.color + '66'), ...M.filter(m => m.cost === 0).map(m => m.color + '22')],
        borderColor: [...paidM.map(m => m.color), ...M.filter(m => m.cost === 0).map(m => m.color + '44')],
        borderWidth: 1.5, borderRadius: 6 }] },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => c.parsed.y === 0 ? 'Free' : '$' + c.parsed.y.toFixed(4) + '/point' } } },
      scales: { y: { title: { display: true, text: '$/quality point' }, grid: { color: tc.gridColor } }, x: { grid: { display: false } } } }
  });

  // Quality vs Speed bubble
  chartInstances.qualitySpeed = new Chart(document.getElementById('qualitySpeedChart'), {
    type: 'bubble', data: { datasets: M.map(m => ({ label: m.name, data: [{ x: m.tps, y: m.quality, r: Math.sqrt(m.tokens) / 10 }], backgroundColor: m.color + '55', borderColor: m.color, borderWidth: 2 })) },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { padding: 14, usePointStyle: true, pointStyle: 'circle', font: { size: 11 } } }, tooltip: { callbacks: { label: c => [c.dataset.label, 'Speed: ' + c.raw.x + ' tok/s', 'Quality: ' + c.raw.y + '/10'] } } },
      scales: { x: { title: { display: true, text: 'Tokens/sec (log)' }, type: 'logarithmic', grid: { color: tc.gridColor } }, y: { title: { display: true, text: 'Quality Score' }, min: 4, max: 10, grid: { color: tc.gridColor } } } }
  });

  // Radar
  chartInstances.radar = new Chart(document.getElementById('radarChart'), {
    type: 'radar', data: { labels: CAT_REORDERED.map(c => c.label), datasets: M.map((m, i) => ({ label: m.name, data: CAT_REORDERED.map(c => c.data[i]), borderColor: m.color, backgroundColor: m.color + '12', borderWidth: 2, pointRadius: 3, pointBackgroundColor: m.color, pointBorderColor: tc.bgDeep, pointBorderWidth: 1.5 })) },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { padding: 14, usePointStyle: true, pointStyle: 'circle', font: { size: 10 } } } }, scales: { r: { min: 0, max: 10, grid: { color: tc.gridColor.replace('44','') }, angleLines: { color: tc.gridColor.replace('44','') }, pointLabels: { font: { size: 10 }, color: tc.textColor }, ticks: { display: false } } } }
  });
}

// Speed bars (static -- don't need recreation, colors are inline)
const sb = document.getElementById('speedBars');
const maxTps = Math.max(...M.map(m => m.tps));
M.forEach(m => {
  const pct = (m.tps / maxTps * 100).toFixed(1);
  sb.innerHTML += '<div class="speed-bar-row"><div class="speed-bar-name" style="color:' + m.color + '">' + m.name + '</div><div class="speed-bar-track"><div class="speed-bar-fill" style="background:' + m.color + '44;border:1px solid ' + m.color + ';--target:' + pct + '%"></div></div><div class="speed-bar-value" style="color:' + m.color + '">' + m.tps + '</div></div>';
});

// Heatmap (static)
const hm = document.getElementById('heatmap');
hm.innerHTML = '<div class="heatmap-header cat-label">Category</div>';
M.forEach(m => { hm.innerHTML += '<div class="heatmap-header" style="color:' + m.color + ';font-size:9px">' + m.name.replace('Claude ','').replace(':14b','') + '</div>'; });
CAT_REORDERED.forEach(cat => {
  hm.innerHTML += '<div class="heatmap-cat">' + cat.label + '</div>';
  cat.data.forEach((val, i) => {
    const green = Math.max(0, (val - 1) / 9);
    const bg = val <= 2 ? 'rgba(244,63,94,0.2)' : 'rgba(16,185,129,' + (green * 0.4) + ')';
    const clr = val <= 2 ? '#f43f5e' : val >= 8 ? '#10b981' : '#f0f4f8';
    hm.innerHTML += '<div class="heatmap-cell" style="background:' + bg + ';color:' + clr + '">' + val.toFixed(1) + '</div>';
  });
});

// Comparison table
const tb = document.getElementById('compTableBody');
M.sort((a, b) => b.quality - a.quality).forEach(m => {
  const qClass = m.quality >= 8 ? 'quality-high' : m.quality >= 6.5 ? 'quality-mid' : 'quality-low';
  tb.innerHTML += '<tr><td class="model-name-cell" style="color:' + m.color + '">' + m.name + '</td><td>' + m.type + '</td><td>' + m.tps + '</td><td>' + m.ttft + 's</td><td>' + m.totalTime + 's</td><td><span class="quality-badge ' + qClass + '">' + m.quality.toFixed(2) + '</span></td><td>' + m.tokens.toLocaleString() + '</td><td>' + (m.cost > 0 ? '$' + m.cost.toFixed(2) : 'Free') + '</td></tr>';
});

// Create charts initially
createAllCharts();

// Scroll animations
const obs = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      e.target.classList.add('visible');
      e.target.querySelectorAll('.speed-bar-fill').forEach(bar => {
        setTimeout(() => { bar.style.width = bar.style.getPropertyValue('--target'); }, 200);
      });
    }
  });
}, { threshold: 0.12 });
document.querySelectorAll('.reveal').forEach(el => obs.observe(el));

// Theme switching
function setTheme(theme) {
  if (theme === 'dark') {
    document.documentElement.removeAttribute('data-theme');
  } else {
    document.documentElement.setAttribute('data-theme', theme);
  }
  localStorage.setItem('llm-theme', theme);
  updateThemeButtons(theme);
  // Recreate charts with new theme colors after a brief delay for CSS to apply
  setTimeout(createAllCharts, 50);
}

function updateThemeButtons(active) {
  document.querySelectorAll('[data-theme-btn]').forEach(function(btn) {
    var isActive = btn.getAttribute('data-theme-btn') === active;
    btn.style.background = isActive ? 'var(--accent)' : 'transparent';
    btn.style.color = isActive ? 'var(--bg-deep)' : 'var(--text-secondary)';
    btn.style.borderColor = isActive ? 'var(--accent)' : 'var(--border)';
  });
}

// Initialize theme buttons
(function() {
  var t = localStorage.getItem('llm-theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
  updateThemeButtons(t);
})();

// Mobile nav: close menu when a link is clicked
document.querySelectorAll('nav .nav-links a').forEach(function(link) {
  link.addEventListener('click', function() {
    var toggle = document.querySelector('.nav-toggle');
    var links = document.querySelector('nav .nav-links');
    if (toggle && links) {
      toggle.classList.remove('active');
      links.classList.remove('open');
    }
  });
});

// =========================================================
// 1.1 Reading Progress Bar
// =========================================================
(function() {
  var progressBar = document.getElementById('readingProgress');
  window.addEventListener('scroll', function() {
    var scrollTop = window.scrollY;
    var docHeight = document.documentElement.scrollHeight - window.innerHeight;
    if (docHeight > 0) {
      progressBar.style.width = (scrollTop / docHeight * 100) + '%';
    }
  }, { passive: true });
})();

// =========================================================
// 1.2 Scroll-to-Top Button
// =========================================================
(function() {
  var btn = document.getElementById('scrollTopBtn');
  window.addEventListener('scroll', function() {
    if (window.scrollY > 400) {
      btn.classList.add('visible');
    } else {
      btn.classList.remove('visible');
    }
  }, { passive: true });
  btn.addEventListener('click', function() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
})();

// =========================================================
// Section Anchor Links (5.1)
// =========================================================
(function() {
  var sectionIds = ['overview', 'speed', 'quality', 'categories', 'deep-dive', 'insights'];
  // Add anchors to section titles (h2.section-title)
  document.querySelectorAll('.section-title').forEach(function(h2) {
    var section = h2.closest('section');
    if (section && section.id) {
      var anchor = document.createElement('a');
      anchor.className = 'section-anchor';
      anchor.href = '#' + section.id;
      anchor.textContent = '#';
      anchor.addEventListener('click', function(e) {
        e.preventDefault();
        history.replaceState(null, '', '#' + section.id);
        var url = window.location.href;
        navigator.clipboard.writeText(url).then(function() {
          showAnchorToast();
        });
      });
      h2.appendChild(anchor);
    }
  });
  // Add anchors to chart card h3 titles
  document.querySelectorAll('.chart-card h3').forEach(function(h3) {
    var card = h3.closest('.chart-card');
    if (!card) return;
    var section = card.closest('section');
    if (section && section.id) {
      var anchor = document.createElement('a');
      anchor.className = 'section-anchor';
      anchor.href = '#' + section.id;
      anchor.textContent = '#';
      anchor.addEventListener('click', function(e) {
        e.preventDefault();
        history.replaceState(null, '', '#' + section.id);
        navigator.clipboard.writeText(window.location.href).then(function() {
          showAnchorToast();
        });
      });
      h3.appendChild(anchor);
    }
  });
  function showAnchorToast() {
    var toast = document.getElementById('anchorToast');
    toast.classList.add('show');
    setTimeout(function() { toast.classList.remove('show'); }, 1800);
  }
})();

// =========================================================
// 1.3 Keyboard Shortcuts + Help Overlay
// =========================================================
(function() {
  var shortcutsOverlay = document.getElementById('shortcutsOverlay');
  var shortcutsBackdrop = document.getElementById('shortcutsBackdrop');
  var shortcutsClose = document.getElementById('shortcutsClose');
  var cmdPaletteOverlay = document.getElementById('cmdPaletteOverlay');

  function openShortcuts() {
    shortcutsOverlay.classList.add('open');
  }
  function closeShortcuts() {
    shortcutsOverlay.classList.remove('open');
  }
  function toggleShortcuts() {
    if (shortcutsOverlay.classList.contains('open')) {
      closeShortcuts();
    } else {
      closeCmdPalette();
      openShortcuts();
    }
  }

  shortcutsBackdrop.addEventListener('click', closeShortcuts);
  shortcutsClose.addEventListener('click', closeShortcuts);

  // Theme cycling
  var themes = ['dark', 'light', 'neon', 'solarized'];
  function cycleTheme() {
    var current = localStorage.getItem('llm-theme') || 'dark';
    var idx = themes.indexOf(current);
    var next = themes[(idx + 1) % themes.length];
    setTheme(next);
  }

  // Section jump targets
  var sectionTargets = [
    { id: 'overview', num: 1 },
    { id: 'speed', num: 2 },
    { id: 'quality', num: 3 },
    { id: 'categories', num: 4 },
    { id: 'deep-dive', num: 5 },
    { id: 'insights', num: 6 },
  ];

  function isInputFocused() {
    var tag = document.activeElement && document.activeElement.tagName;
    return tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT';
  }

  document.addEventListener('keydown', function(e) {
    // Cmd+K / Ctrl+K: command palette (always works, even in inputs)
    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
      e.preventDefault();
      toggleCmdPalette();
      return;
    }

    // Esc: close any overlay
    if (e.key === 'Escape') {
      if (cmdPaletteOverlay.classList.contains('open')) {
        closeCmdPalette();
        return;
      }
      if (shortcutsOverlay.classList.contains('open')) {
        closeShortcuts();
        return;
      }
      return;
    }

    // Guard: ignore single-key shortcuts when in input
    if (isInputFocused()) return;

    switch (e.key) {
      case '?':
        e.preventDefault();
        toggleShortcuts();
        break;
      case 't':
        e.preventDefault();
        cycleTheme();
        break;
      case 'g':
        e.preventDefault();
        window.open('https://github.com/parsamivehchi/tps.sh', '_blank');
        break;
      case 'Home':
      case '0':
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: 'smooth' });
        break;
      case 'n':
        e.preventDefault();
        window.location.href = 'hardware.html';
        break;
      case 'l':
        e.preventDefault();
        window.location.href = '../index.html';
        break;
      case 'm':
        e.preventDefault();
        window.open('https://parsamivehchi.github.io/LLM-Setup-Kit-for-Mac/', '_blank');
        break;
      default:
        // Number keys 1-6 for section jumps
        var num = parseInt(e.key, 10);
        if (num >= 1 && num <= 6) {
          e.preventDefault();
          var target = sectionTargets[num - 1];
          var el = document.getElementById(target.id);
          if (el) el.scrollIntoView({ behavior: 'smooth' });
        }
        break;
    }
  });

  // Expose for command palette
  window._openShortcuts = openShortcuts;
  window._cycleTheme = cycleTheme;
})();

// =========================================================
// Command Palette (Batch 4)
// =========================================================
var closeCmdPalette, toggleCmdPalette;
(function() {
  var overlay = document.getElementById('cmdPaletteOverlay');
  var backdrop = document.getElementById('cmdPaletteBackdrop');
  var input = document.getElementById('cmdPaletteInput');
  var list = document.getElementById('cmdPaletteList');
  var activeIndex = 0;

  var commands = [
    { cat: 'Section', name: 'Go to Overview', action: function() { document.getElementById('overview').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Section', name: 'Go to Speed', action: function() { document.getElementById('speed').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Section', name: 'Go to Quality', action: function() { document.getElementById('quality').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Section', name: 'Go to Categories', action: function() { document.getElementById('categories').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Section', name: 'Go to Full Data', action: function() { document.getElementById('deep-dive').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Section', name: 'Go to Insights', action: function() { document.getElementById('insights').scrollIntoView({ behavior: 'smooth' }); } },
    { cat: 'Theme', name: 'Theme: Dark', action: function() { setTheme('dark'); } },
    { cat: 'Theme', name: 'Theme: Light', action: function() { setTheme('light'); } },
    { cat: 'Theme', name: 'Theme: Neon', action: function() { setTheme('neon'); } },
    { cat: 'Theme', name: 'Theme: Solarized', action: function() { setTheme('solarized'); } },
    { cat: 'Page', name: 'Go to Landing Page', action: function() { window.location.href = '../index.html'; } },
    { cat: 'Page', name: 'Go to Hardware Guide', action: function() { window.location.href = 'hardware.html'; } },
    { cat: 'Page', name: 'Go to Setup Kit', action: function() { window.open('https://parsamivehchi.github.io/LLM-Setup-Kit-for-Mac/', '_blank'); } },
    { cat: 'Action', name: 'Open GitHub Repository', action: function() { window.open('https://github.com/parsamivehchi/tps.sh', '_blank'); } },
    { cat: 'Action', name: 'Show Keyboard Shortcuts', action: function() { window._openShortcuts(); } },
  ];

  function getFiltered() {
    var q = input.value.toLowerCase().trim();
    if (!q) return commands;
    return commands.filter(function(c) {
      return c.name.toLowerCase().includes(q) || c.cat.toLowerCase().includes(q);
    });
  }

  function render() {
    var filtered = getFiltered();
    if (filtered.length === 0) {
      list.innerHTML = '<div class="cmd-palette-empty">No matching commands</div>';
      return;
    }
    list.innerHTML = '';
    filtered.forEach(function(cmd, i) {
      var item = document.createElement('div');
      item.className = 'cmd-palette-item' + (i === activeIndex ? ' active' : '');
      item.innerHTML = '<span class="cmd-cat">' + cmd.cat + '</span><span class="cmd-name">' + cmd.name + '</span>';
      item.addEventListener('click', function() {
        closeCmdPalette();
        cmd.action();
      });
      item.addEventListener('mouseenter', function() {
        activeIndex = i;
        updateActive();
      });
      list.appendChild(item);
    });
  }

  function updateActive() {
    var items = list.querySelectorAll('.cmd-palette-item');
    items.forEach(function(item, i) {
      item.classList.toggle('active', i === activeIndex);
    });
    // Scroll active into view
    var activeItem = list.querySelector('.cmd-palette-item.active');
    if (activeItem) {
      activeItem.scrollIntoView({ block: 'nearest' });
    }
  }

  function openPalette() {
    overlay.classList.add('open');
    input.value = '';
    activeIndex = 0;
    render();
    setTimeout(function() { input.focus(); }, 50);
  }

  closeCmdPalette = function() {
    overlay.classList.remove('open');
    input.value = '';
  };

  toggleCmdPalette = function() {
    if (overlay.classList.contains('open')) {
      closeCmdPalette();
    } else {
      // Close shortcuts if open
      document.getElementById('shortcutsOverlay').classList.remove('open');
      openPalette();
    }
  };

  backdrop.addEventListener('click', closeCmdPalette);

  input.addEventListener('input', function() {
    activeIndex = 0;
    render();
  });

  input.addEventListener('keydown', function(e) {
    var filtered = getFiltered();
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      activeIndex = Math.min(activeIndex + 1, filtered.length - 1);
      updateActive();
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      activeIndex = Math.max(activeIndex - 1, 0);
      updateActive();
    } else if (e.key === 'Enter') {
      e.preventDefault();
      if (filtered[activeIndex]) {
        closeCmdPalette();
        filtered[activeIndex].action();
      }
    }
  });
})();

// =========================================================
// Welcome Toast — First Visit Only
// =========================================================
(function() {
  var WELCOME_KEY = 'tps-welcome-seen';
  if (!localStorage.getItem(WELCOME_KEY)) {
    var toast = document.getElementById('welcomeToast');
    if (toast) {
      setTimeout(function() { toast.classList.add('visible'); }, 1500);
      localStorage.setItem(WELCOME_KEY, '1');
      var dismiss = function() {
        toast.classList.remove('visible');
        toast.classList.add('hiding');
      };
      document.getElementById('welcomeDismiss').addEventListener('click', dismiss);
      setTimeout(dismiss, 9500);
    }
  }
})();
</script>
</body>
</html>
